# WP-Create

This repository contains shell scripts designed to automate the creation and removal of local WordPress sites running on Ubuntu.

## Prerequisites

**Ubuntu (or WSL2 running Ubuntu)** with:
- PHP 8.2+ with the curl, dom, gd, json, mbstring, mysqli, openssl, xml, zip modules enabled
- Apache with mod_rewrite enabled
- MariaDB 10.6+ with root access
- wp-cli (The `wp-create.sh` script will attempt to install it if it isn't installed)

## Scripts

### `wp-create.sh`
This script uses set variables in an `.env` file to automate the creation of local WordPress sites.
See the [sample .env file](.env-sample)

It prompts for a `TITLE` and a `SLUG`. If no `TITLE` is provided, it defaults to 'WordPress'.
If no `SLUG` is provided, it defaults to an 8 character or less `SLUG` generated by the `TITLE`.
It then performs the following functions:

- Creates the necessary directory structure at '`DEV_DIR`/`SLUG`/wordpress'
- Installs `wp-cli` if necessary
- Downloads the latest version of WordPress
- Creates the wp-config.php file
- Creates the database user `DB_USER` if they do not already exist
- Creates a database named '`SLUG`' and grants all permissions to `DB_USER`
- Installs WordPress with the database tables prefixed with 'wp_`SLUG`_' 
- Checks `DB_DUMP_DIR` for an existing database dump file and imports it. In this order:
	1. `SLUG`-dev.sql
	2. `SLUG`.sql
	3. `SLUG`-prod.sql
- Installs and activates the [Simple SMTP Mailer](https://wordpress.org/plugins/simple-smtp-mailer) plugin if ${SMTP_USER} and ${SMTP_PASS} are set.

### `wp-destroy.sh`
Removes a WordPress site created from running the `wp-build.sh` script.
==This script removes everything and should be used with extreme caution.==

It prompts for the `SLUG`, which is required.
It also asks you if you want to delete the database.

## Usage

1. Create and/or navigate to the directory where you want to create WordPress sites (Should be the same as `DEV_DIR`)

```sh
mkdir -p /path/to/dev/directory && cd /path/to/dev/directory
```

2. Clone (or download and extract) the repository into the directory

```sh
git clone git@github.com:joshmckibbin/wp-create.git .
```

3. Make sure you have execute permissions for the scripts

```sh
chmod +x wp-create.sh wp-destroy.sh
```

4. Copy the `.env-sample` file to `.env` and replace the environment values with your own.

```sh
cp .env-sample .env
```

5. Run one of the shell scripts

```sh
./wp-build.sh
```

6. Profit?

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.